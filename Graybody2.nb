Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Physical", " ", "constants", " ", "in", " ", "cgs", " ", "units"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"G", "=", 
    RowBox[{"6.67", " ", 
     SuperscriptBox["10", 
      RowBox[{"-", "8"}]]}]}], ";"}], "  ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Newton", "'"}], "s", " ", "constant", " ", "in", " ", "cgs"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"c", "=", 
    RowBox[{"3", " ", 
     SuperscriptBox["10", "10"]}]}], " ", ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"Speed", " ", "of", " ", "light", " ", "in", " ", "cgs"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Kappa]r", "=", 
   RowBox[{"1.6", " ", 
    SuperscriptBox["10", "24"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kb", "=", 
   RowBox[{"1.38", " ", 
    SuperscriptBox["10", 
     RowBox[{"-", "16"}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Mu]0", "=", "0.615"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mp", "=", 
    RowBox[{"1.67", " ", 
     SuperscriptBox["10", 
      RowBox[{"-", "24"}]]}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Stefan", "-", 
    RowBox[{"Boltzmann", " ", "constant", " ", "in", " ", "cgs"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]", "=", 
   RowBox[{"5.67", " ", 
    SuperscriptBox["10", 
     RowBox[{"-", "5"}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"h", "=", 
   RowBox[{"6.63", " ", 
    SuperscriptBox["10", 
     RowBox[{"-", "27"}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Msun", "=", 
    RowBox[{"2", " ", 
     SuperscriptBox["10", "33"]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"B", "[", "Teff_", "]"}], ":=", 
  FractionBox[
   RowBox[{"(", 
    RowBox[{"2", " ", "h", " ", 
     RowBox[{
      SuperscriptBox["\[Nu]1", "3"], "/", 
      SuperscriptBox["c", "2"]}]}], ")"}], 
   RowBox[{
    SuperscriptBox["E", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"h", " ", "\[Nu]1"}], ")"}], "/", 
      RowBox[{"(", " ", 
       RowBox[{"kb", " ", "Teff"}], ")"}]}]], "-", 
    "1"}]]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Nu]peak", "[", "Teff_", "]"}], ":=", 
   RowBox[{"2.82", " ", "kb", " ", 
    FractionBox["Teff", "h"]}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Calculates", " ", "graybody", " ", "atmosphere", " ", "using", " ", 
     RowBox[{"Taka", "'"}], "s", " ", "formalism", " ", "for", " ", "a", " ", 
     "particular", " ", "Teff", " ", "and", " ", "gravity", " ", 
     RowBox[{"parameter", ".", " ", "Free"}], " ", "is", " ", "a", " ", 
     "flag", " ", "to", " ", "switch", " ", "between", " ", "the", " ", 
     "free"}], "-", 
    RowBox[{"free", " ", "and", " ", "bound"}], "-", 
    RowBox[{"free", " ", "opacities"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GrayBody", "[", 
    RowBox[{"Teff_", ",", " ", "Qg_", ",", " ", 
     RowBox[{"Free_:", "False"}], ",", " ", 
     RowBox[{"prec_:", 
      SuperscriptBox["10", 
       RowBox[{"-", "8"}]]}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[Kappa]es", ",", " ", "\[Kappa]s", ",", " ", "\[Kappa]sb", ",", " ", 
       "\[Kappa]sf", ",", " ", "\[Epsilon]s", ",", "  ", "\[Xi]", ",", " ", 
       "f", ",", " ", "x", "  ", ",", " ", "K", ",", " ", "\[Epsilon]", ",", 
       " ", "Tp", ",", " ", "\[CapitalXi]", ",", " ", "\[Rho]p", ",", " ", 
       "pr", ",", " ", "pg", ",", " ", "r", ",", " ", "error"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Kappa]es", "=", "0.4"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Note", " ", "that", " ", "the", " ", "below", " ", "expression", " ", 
        "for", " ", "\[Kappa]s", " ", "assumes", " ", "radiation", " ", 
        "pressure", " ", 
        RowBox[{"dominance", ".", " ", "We"}], " ", "also", " ", "assume", 
        " ", "solar", " ", "metallicities"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"\[Kappa]sb", "=", 
       RowBox[{"4.7", " ", 
        SuperscriptBox["10", "20"], 
        SqrtBox["Qg"], 
        SuperscriptBox["Tp", 
         RowBox[{
          RowBox[{"-", "15"}], "/", "4"}]]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Kappa]sf", "=", 
       RowBox[{"0.04", " ", "\[Kappa]sb"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{"If", " ", "the", " ", "free"}], "-", 
         RowBox[{"free", " ", "opacity", " ", "dominates"}]}], ";", " ", 
        RowBox[{
         RowBox[{"Note", " ", "we", " ", "assume", " ", "a", " ", "H"}], "-", 
         
         RowBox[{
         "He", " ", "atmosphere", " ", "with", " ", "solar", " ", 
          "abundances"}]}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"Free", ",", " ", 
        RowBox[{"\[Kappa]s", "=", " ", "\[Kappa]sf"}], ",", " ", 
        RowBox[{"\[Kappa]s", "=", "\[Kappa]sb"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"\[Kappa]s", "=", 
        RowBox[{"1.83", " ", 
         SuperscriptBox["10", "9"], " ", 
         SqrtBox["Qg"], 
         RowBox[{"(", "Teff", 
          SuperscriptBox[")", 
           RowBox[{
            RowBox[{"-", "9"}], "/", "4"}]]}]}]}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"\[Epsilon]s", "=", 
       FractionBox["\[Kappa]s", 
        RowBox[{"\[Kappa]s", "+", "\[Kappa]es"}]]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[CapitalXi]", "=", 
       RowBox[{
        FractionBox[
         RowBox[{"0.873", " ", 
          SuperscriptBox["\[Epsilon]s", 
           RowBox[{
            RowBox[{"-", "1"}], "/", "6"}]]}], 
         RowBox[{"1", "-", 
          RowBox[{"0.127", " ", 
           SuperscriptBox["\[Epsilon]s", 
            RowBox[{"5", "/", "6"}]]}]}]], 
        FractionBox["1", 
         RowBox[{"1", "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["\[Epsilon]s", 
              RowBox[{"-", "1"}]], "-", "1"}], ")"}], 
           RowBox[{"2", "/", "3"}]]}]]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"r", "=", 
       RowBox[{"FindRoot", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           SuperscriptBox["Teff", "4"], "-", 
           RowBox[{"\[CapitalXi]", "  ", 
            SuperscriptBox["Tp", "4"]}]}], "\[Equal]", "0"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"Tp", ",", " ", "Teff"}], "}"}]}], 
        RowBox[{"(*", 
         RowBox[{",", " ", 
          RowBox[{"EvaluationMonitor", "\[RuleDelayed]", " ", 
           RowBox[{"Print", "[", " ", 
            RowBox[{"Tp", ",", " ", "\"\<  \>\"", ",", " ", 
             RowBox[{"Tp", "//", "Im"}], ",", " ", "\"\<  \>\"", ",", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "\[CapitalXi]"}], "  ", 
               SuperscriptBox["Tp", "4"]}], "//", "Im"}]}], "]"}]}]}], " ", 
         "*)"}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Plot", "[", 
        RowBox[{
         RowBox[{
          SuperscriptBox["Teff", "4"], "-", " ", 
          RowBox[{"\[CapitalXi]", " ", 
           SuperscriptBox["Tp", "4"]}]}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"Tp", ",", " ", 
           RowBox[{
            RowBox[{"0.99", " ", "Tp"}], "/.", "r"}], ",", " ", 
           RowBox[{
            RowBox[{"1.01", " ", "Tp"}], "/.", "r"}]}], "}"}]}], "]"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Correction", " ", "to", " ", "total", " ", "flux", " ", "from", " ", 
        "scattering"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Tp", "=", 
       RowBox[{"Tp", "/.", "r"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"x", "=", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          FractionBox["1", "\[Epsilon]s"]}], ")"}], 
        RowBox[{"-", "1"}]]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Xi]", "=", 
       FractionBox[
        RowBox[{"h", " ", "\[Nu]1"}], 
        RowBox[{"kb", " ", "Teff"}]]}], ";", "\[IndentingNewLine]", 
      RowBox[{"f", "=", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", "\[Xi]", ")"}], 
         RowBox[{"-", "3"}]], 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"-", "\[Xi]"}]]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Solve", " ", "cubic", " ", "equation", " ", "for", " ", "the", " ", 
        "ratio", " ", "of", " ", "absorption", " ", "opacity", " ", "to", " ",
         "scattering", " ", "opacity"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"K", "=", 
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", "3"]}], "+", 
        FractionBox[
         SuperscriptBox["2", 
          RowBox[{"1", "/", "3"}]], 
         RowBox[{"3", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "2"}], "+", 
             RowBox[{"27", " ", "f", " ", 
              SuperscriptBox["x", "2"]}], "+", 
             SqrtBox[
              RowBox[{
               RowBox[{"-", "4"}], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "2"}], "+", 
                  RowBox[{"27", " ", "f", " ", 
                   SuperscriptBox["x", "2"]}]}], ")"}], "2"]}]]}], ")"}], 
           RowBox[{"1", "/", "3"}]]}]], "+", 
        FractionBox[
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "2"}], "+", 
            RowBox[{"27", " ", "f", " ", 
             SuperscriptBox["x", "2"]}], "+", 
            SqrtBox[
             RowBox[{
              RowBox[{"-", "4"}], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "2"}], "+", 
                 RowBox[{"27", " ", "f", " ", 
                  SuperscriptBox["x", "2"]}]}], ")"}], "2"]}]]}], ")"}], 
          RowBox[{"1", "/", "3"}]], 
         RowBox[{"3", " ", 
          SuperscriptBox["2", 
           RowBox[{"1", "/", "3"}]]}]]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Estimate", " ", "density", " ", "at", " ", "the", " ", "base", " ", 
        "of", " ", "the", " ", "photosphere", " ", "for", " ", "the", " ", 
        "peak", " ", "frequency"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"\[Rho]p", "=", " ", 
       RowBox[{
        FractionBox[
         RowBox[{"3", " ", "c", " ", "Qg"}], 
         RowBox[{"4", " ", 
          RowBox[{"(", "\[Gamma]", ")"}], " ", "\[Sigma]", " ", 
          SuperscriptBox["Tp", "4"], "    ", 
          SuperscriptBox["\[Kappa]es", "2"], 
          RowBox[{"(", 
           RowBox[{"1", "+", "K"}], ")"}], "K"}]], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[Nu]1", "\[Rule]", 
           RowBox[{"\[Nu]peak", "[", "Teff", "]"}]}], ",", " ", 
          RowBox[{"\[Gamma]", "\[Rule]", 
           RowBox[{"4", "/", "3"}]}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Estimate", " ", "ratio", " ", "of", " ", "gas", " ", "pressure", " ", 
        "to", " ", "radiation", " ", "pressure"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"pr", "=", 
       RowBox[{
        FractionBox[
         RowBox[{"4", "\[Sigma]"}], 
         RowBox[{"3", "c"}]], 
        SuperscriptBox["Tp", "4"]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"pg", "=", " ", 
       FractionBox[
        RowBox[{"\[Rho]p", " ", "kb", " ", "Tp"}], 
        RowBox[{"\[Mu]0", " ", "mp"}]]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Epsilon]", "=", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", 
           FractionBox["1", "K"]}], ")"}], 
         RowBox[{"-", "1"}]], "//", "Simplify"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"error", "=", 
       RowBox[{"Abs", "[", 
        FractionBox[
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[CapitalXi]", " ", 
             SuperscriptBox["Tp", "4"]}], "/.", "r"}], ")"}], "-", 
          SuperscriptBox["Teff", "4"]}], 
         SuperscriptBox["Teff", "4"]], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"error", ">", "prec"}], ",", " ", 
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<Warning! Error in flux has exceeded the specified threshold. \
Error is \>\"", ",", " ", "error"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        FractionBox["pr", "pg"], ",", " ", "Tp", ",", " ", "\[Epsilon]", ",", 
        " ", 
        FractionBox[
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[CapitalXi]", " ", 
             SuperscriptBox["Tp", "4"]}], "/.", "r"}], ")"}], "-", 
          SuperscriptBox["Teff", "4"]}], 
         SuperscriptBox["Teff", "4"]]}], "}"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PlotSpec", "[", " ", 
   RowBox[{
    RowBox[{"file_:", "\"\<fort.14\>\""}], ",", " ", 
    RowBox[{"color_:", "Black"}], ",", 
    RowBox[{"xrange_:", 
     RowBox[{"{", "}"}]}], ",", " ", 
    RowBox[{"nmu_:", "10"}], ",", " ", 
    RowBox[{"mu_:", "1"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "dat", ",", " ", "int", ",", " ", "\[Lambda]", ",", " ", "\[Nu]", ",", 
      " ", "\[Lambda]h", ",", " ", "\[Nu]h", ",", " ", "\[Nu]peak", ",", " ", 
      "imu", ",", " ", "peak", ",", " ", "prange"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"SetDirectory", "[", 
      RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dat", "=", 
      RowBox[{"ReadList", "[", 
       RowBox[{"file", ",", " ", "Number", ",", " ", 
        RowBox[{"RecordLists", "\[Rule]", "True"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"wavelengths", " ", "in", " ", "angstroms"}], " ", "+", " ", 
       "fluxes"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"\[Lambda]h", "=", 
      RowBox[{"Extract", "[", 
       RowBox[{"dat", ",", " ", 
        RowBox[{"Position", "[", 
         RowBox[{"dat", ",", " ", 
          RowBox[{"x_", "/;", 
           RowBox[{
            RowBox[{"Length", "[", "x", "]"}], "\[Equal]", "2"}]}]}], "]"}]}],
        "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Lambda]h", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", " ", "2"}], "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{"\[Lambda]h", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "2"}], "]"}], "]"}], " ", "4", "\[Pi]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Nu]h", "=", "\[Lambda]h"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Getting", " ", "frequency", " ", "information"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Nu]h", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "1"}], "]"}], "]"}], "=", 
      RowBox[{
       FractionBox["c", 
        RowBox[{"\[Lambda]h", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", " ", "1"}], "]"}], "]"}]], " ", 
       SuperscriptBox["10", "8"]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Nu]", "=", 
      RowBox[{"\[Nu]h", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"peak", "=", 
      RowBox[{
       RowBox[{"\[Nu]", " ", 
        RowBox[{"\[Nu]h", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "2"}], "]"}], "]"}]}], "//", "Max"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Nu]peak", "=", 
      RowBox[{"\[Nu]", "[", 
       RowBox[{"[", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Nu]h", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "2"}], "]"}], "]"}], "//", "Ordering"}], "//", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", 
             RowBox[{"-", "1"}], "]"}], "]"}], "&"}]}], ")"}], "]"}], "]"}]}],
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Extract", " ", "the", " ", "specific", " ", "intensities"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"imu", "=", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{"dat", ",", " ", 
        RowBox[{"x_", "/;", 
         RowBox[{
          RowBox[{"Length", "[", "x", "]"}], "\[Equal]", "2"}]}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"imu", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"imu", "//", "Flatten"}], "//", 
        RowBox[{
         RowBox[{"Partition", "[", 
          RowBox[{"#", ",", " ", 
           RowBox[{"2", "*", "nmu"}]}], "]"}], "&"}]}], "//", 
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", " ", "mu"}], "]"}], "]"}], "&"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"xrange", "\[Equal]", 
        RowBox[{"{", "}"}]}], ",", " ", 
       RowBox[{"prange", "=", "Automatic"}], ",", " ", 
       RowBox[{"prange", "=", "xrange"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"ListLogLogPlot", "[", 
      RowBox[{
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{"\[Nu]", ",", " ", 
          RowBox[{
           RowBox[{"\[Nu]h", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "2"}], "]"}], "]"}], " ", "\[Nu]"}]}], "}"}],
         "]"}], ",", " ", 
       RowBox[{"AxesLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
         "\"\<\[Nu] [\!\(\*SuperscriptBox[\(s\), \(-1\)]\)]\>\"", ",", " ", 
          "\"\<\[Nu] \!\(\*SubscriptBox[\(F\), \(\[Nu]\)]\) [erg \
\!\(\*SuperscriptBox[\(cm\), \(-2\)]\) \!\(\*SuperscriptBox[\(s\), \(-1\)]\)]\
\>\""}], "}"}]}], ",", "  ", 
       RowBox[{"Joined", "\[Rule]", "True"}], ",", " ", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"Directive", "[", "color", "]"}]}], ",", " ", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"prange", ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             SuperscriptBox["10", 
              RowBox[{"-", "6"}]], "peak"}], " ", ",", " ", "peak"}], "}"}]}],
          "}"}]}], ",", " ", 
       RowBox[{"PlotRangeClipping", "\[Rule]", "False"}], ",", " ", 
       RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Opac", "[", " ", 
    RowBox[{
     RowBox[{"file_:", "\"\<fort.85\>\""}], ",", " ", 
     RowBox[{"nd_:", "70"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Kappa]", ",", " ", "\[Nu]", ",", " ", "dat"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"SetDirectory", "[", 
       RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dat", "=", 
       RowBox[{"ReadList", "[", 
        RowBox[{"file", ",", " ", "Number", ",", " ", 
         RowBox[{"RecordLists", "\[Rule]", "True"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", "frequencies", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"\[Nu]", "=", 
       RowBox[{"Extract", "[", 
        RowBox[{"dat", ",", " ", 
         RowBox[{"Position", "[", 
          RowBox[{"dat", ",", " ", 
           RowBox[{"x_", "/;", 
            RowBox[{
             RowBox[{"Length", "[", "x", "]"}], "\[Equal]", "2"}]}]}], 
          "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Nu]", "=", 
       RowBox[{"\[Nu]", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Kappa]", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"DeleteCases", "[", 
          RowBox[{"dat", ",", 
           RowBox[{"x_", "/;", 
            RowBox[{
             RowBox[{"Length", "[", "x", "]"}], "\[Equal]", "2"}]}]}], "]"}], 
         "//", "Flatten"}], "//", 
        RowBox[{
         RowBox[{"Partition", "[", 
          RowBox[{"#", ",", " ", "nd"}], "]"}], "&"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[Nu]", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", " ", 
          RowBox[{"\[Kappa]", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", " ", "1", ",", " ", 
          RowBox[{"Length", "[", "\[Nu]", "]"}]}], "}"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Parses", " ", "a", " ", "model", " ", "atmosphere", " ", "from", " ", "a",
     " ", "unit", " ", "7", " ", "input", " ", "file"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ParseAtm", "[", 
   RowBox[{"file_:", "\"\<fort.7\>\""}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"atm", ",", " ", "m", ",", "nd", ",", " ", "blocks"}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"atm", "=", 
      RowBox[{"ReadList", "[", 
       RowBox[{"file", ",", " ", "Number"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"nd", "=", 
      RowBox[{"atm", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"blocks", "=", 
      RowBox[{"atm", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"atm", "=", 
      RowBox[{"atm", "[", 
       RowBox[{"[", 
        RowBox[{"3", ";;"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"m", "=", 
      RowBox[{"atm", "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", "nd"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"atm", "=", 
      RowBox[{"atm", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"nd", "+", "1"}], ";;"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"atm", "=", 
      RowBox[{
       RowBox[{"Partition", "[", 
        RowBox[{"atm", ",", " ", "blocks"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", " ", 
         RowBox[{"1", ";;", "4"}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"atm", "=", 
      RowBox[{"Flatten", "/@", 
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{"m", ",", " ", "atm"}], "}"}], "]"}]}]}]}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PlotF", "[", " ", 
   RowBox[{
    RowBox[{"file_:", "\"\<fort.13\>\""}], ",", " ", 
    RowBox[{"color_:", "Green"}], ",", " ", 
    RowBox[{"xrange_:", 
     RowBox[{"{", "}"}]}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "fluxdat", ",", " ", "peak", ",", " ", "sed", ",", " ", "peakf", ",", 
      " ", "peakloc", ",", "bad", ",", " ", "prange"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"import", " ", "data", " ", "file"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"fluxdat", "=", " ", 
      RowBox[{
       RowBox[{"Import", "[", 
        RowBox[{"file", ",", " ", "\"\<Table\>\""}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", " ", 
         RowBox[{"1", ";;", "2"}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"fluxdat", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "2"}], "]"}], "]"}], "=", 
      RowBox[{"4", "\[Pi]", " ", 
       RowBox[{"fluxdat", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "2"}], "]"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"sed", "=", 
      RowBox[{"Transpose", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"fluxdat", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"fluxdat", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", " ", "1"}], "]"}], "]"}], "*", 
          RowBox[{"fluxdat", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "2"}], "]"}], "]"}]}]}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Output", " ", "is", " ", "sometimes", " ", "formatted", " ", "in", " ",
        "such", " ", "a", " ", "way", " ", "that", " ", "mathematica", " ", 
       "does", " ", "not", " ", "recognize", " ", "it", " ", "as", " ", "a", 
       " ", "real", " ", "number"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"bad", "=", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{"sed", ",", " ", 
        RowBox[{"x_", "/;", 
         RowBox[{
          RowBox[{"x", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "\[Element]", "Reals"}]}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"sed", "=", 
      RowBox[{"Complement", "[", 
       RowBox[{"sed", ",", " ", "bad"}], "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"(*", 
      RowBox[{
      "Get", " ", "location", " ", "of", " ", "peak", " ", "for", " ", 
       "setting", " ", "the", " ", "range", " ", "of", " ", "the", " ", 
       "plot"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"xrange", "\[Equal]", 
        RowBox[{"{", "}"}]}], ",", " ", 
       RowBox[{"prange", "=", "Automatic"}], ",", " ", 
       RowBox[{"prange", "=", "xrange"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"peakloc", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"sed", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "2"}], "]"}], "]"}], "//", "Ordering"}], "//", 
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", 
          RowBox[{"-", "1"}], "]"}], "]"}], "&"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"peak", "=", 
      RowBox[{"sed", "[", 
       RowBox[{"[", 
        RowBox[{"peakloc", ",", "2"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"ListLogLogPlot", "[", 
      RowBox[{"sed", ",", " ", 
       RowBox[{"Joined", "\[Rule]", "True"}], ",", " ", 
       RowBox[{"PlotRange", "->", 
        RowBox[{"{", 
         RowBox[{"prange", ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             SuperscriptBox["10", 
              RowBox[{"-", " ", "6"}]], "peak"}], ",", " ", 
            RowBox[{"2", "peak"}]}], "}"}]}], "}"}]}], ",", 
       RowBox[{"AxesLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
         "\"\<\[Nu] [\!\(\*SuperscriptBox[\(s\), \(-1\)]\)]\>\"", ",", " ", 
          "\"\<\[Nu] \!\(\*SubscriptBox[\(F\), \(\[Nu]\)]\) [erg \
\!\(\*SuperscriptBox[\(cm\), \(-2\)]\) \!\(\*SuperscriptBox[\(s\), \(-1\)]\)]\
\>\""}], "}"}]}], ",", "  ", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"Directive", "[", "color", "]"}]}], ",", " ", 
       RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GraybodyCompare", "[", 
   RowBox[{
    RowBox[{"file_:", "\"\<fort.13\>\""}], ",", " ", "Teff_", ",", " ", 
    "Qg_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", " ", 
     RowBox[{
     "Tp", ",", " ", "\[Epsilon]", ",", " ", "bb", ",", " ", "gb", ",", " ", 
      "tlustyspec", ",", " ", "gp"}], "}"}], ",", " ", "\[IndentingNewLine]", 
    
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"Teff", "=", 
       SuperscriptBox["10", "4"]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Qg", "=", 
       RowBox[{"5.01", " ", 
        SuperscriptBox["10", 
         RowBox[{"-", "13"}]]}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Tp", "=", 
      RowBox[{
       RowBox[{"GrayBody", "[", 
        RowBox[{"Teff", ",", " ", "Qg"}], "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Epsilon]", "=", 
      RowBox[{
       RowBox[{"GrayBody", "[", 
        RowBox[{"Teff", ",", " ", "Qg"}], "]"}], "[", 
       RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"bb", "=", 
      RowBox[{"\[Pi]", " ", 
       RowBox[{"B", "[", "Teff", "]"}], " ", "\[Nu]1"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"gb", "=", 
      RowBox[{
       RowBox[{"\[Pi]", 
        FractionBox[
         RowBox[{"2", 
          SuperscriptBox["\[Epsilon]", 
           RowBox[{"1", "/", "2"}]]}], 
         RowBox[{"1", "+", 
          SuperscriptBox["\[Epsilon]", 
           RowBox[{"1", "/", "2"}]]}]], " ", 
        RowBox[{"B", "[", "Tp", "]"}], " ", "\[Nu]1"}], "//", "Re"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"tlustyspec", "=", 
      RowBox[{"PlotF", "[", 
       RowBox[{"file", ",", "Green", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"0.1", " ", 
           RowBox[{"\[Nu]peak", "[", "Teff", "]"}]}], ",", " ", 
          RowBox[{"10", " ", 
           RowBox[{"\[Nu]peak", "[", "Teff", "]"}]}]}], "}"}]}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"gp", "=", 
      RowBox[{"LogLogPlot", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"bb", ",", " ", "gb"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"\[Nu]1", ",", " ", 
          RowBox[{"0.1", " ", 
           RowBox[{"\[Nu]peak", "[", "Teff", "]"}]}], ",", " ", 
          RowBox[{"10", " ", 
           RowBox[{"\[Nu]peak", "[", "Teff", "]"}]}]}], "}"}], ",", " ", 
        RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"tlustylte", "=", 
        RowBox[{"PlotSpec", "[", 
         RowBox[{
         "\"\<~/First_Year_Project/tlusty_tar/examples/aleksey_tlusty_runs/\
t40_solar/t40m56q-143/lteconv/fort.14\>\"", ",", " ", "Blue"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"tlustygray", "=", " ", 
        RowBox[{"PlotSpec", "[", 
         RowBox[{
         "\"\<~/First_Year_Project/tlusty_tar/examples/aleksey_tlusty_runs/\
t40_solar_gray/t40m56q-143/lteconv/fort.14\>\"", ",", " ", "Purple"}], 
         "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Show", "[", 
      RowBox[{"{", 
       RowBox[{"tlustyspec", ",", " ", "gp"}], "}"}], "]"}]}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GraybodyCompare2", "[", 
    RowBox[{"dir_", ",", " ", "Teff_", ",", " ", "Qg_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "o", ",", " ", "atm", ",", "  ", "dens", " ", ",", " ", "\[Chi]", ",", 
       " ", "\[Tau]", ",", " ", "near", ",", " ", "pos", ",", " ", "\[Kappa]",
        ",", " ", "\[Sigma]", ",", " ", "ne", ",", "\[Epsilon]", ",", " ", 
       "\[Mu]e", ",", " ", "T", ",", "\[Nu]", ",", "z", ",", " ", "\[Delta]z",
        ",", " ", "spec", ",", " ", "planck", ",", " ", "gp", ",", " ", 
       "tlustyspec", ",", " ", "gb1", ",", " ", "gp1"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"o", "=", 
       RowBox[{"Opac", "[", 
        RowBox[{"dir", "<>", " ", "\"\</fort.85\>\""}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"atm", "=", 
       RowBox[{"ParseAtm", "[", 
        RowBox[{"dir", "<>", "\"\</fort.7\>\""}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ne", "=", 
       RowBox[{"atm", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "3"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dens", "=", 
       RowBox[{"atm", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "4"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"z", "=", 
       RowBox[{"atm", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "5"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"T", "=", 
       RowBox[{"atm", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Delta]z", "=", 
       RowBox[{"z", "//", "Differences"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"o", "=", 
       RowBox[{"o", "//", "Reverse"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Chi]", "=", 
       RowBox[{"o", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Nu]", "=", 
       RowBox[{"o", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Tau]", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{"#", "[", 
            RowBox[{"[", 
             RowBox[{"2", ";;"}], "]"}], "]"}]}], " ", "\[Delta]z", " ", 
          RowBox[{"dens", "[", 
           RowBox[{"[", 
            RowBox[{"2", ";;"}], "]"}], "]"}]}], "&"}], "/@", "\[Chi]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"near", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Nearest", "[", 
          RowBox[{"#", ",", "1"}], "]"}], "&"}], "/@", "\[Tau]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pos", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Position", "[", " ", 
          RowBox[{
           RowBox[{"\[Tau]", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", " ", 
           RowBox[{"near", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "1"}], "]"}], "]"}]}], "]"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"i", ",", " ", "1", ",", " ", 
           RowBox[{"Length", "[", "near", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Total", " ", "opacity", " ", "at", " ", "the", " ", "photosphere"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"\[Chi]", "=", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Extract", "[", 
           RowBox[{
            RowBox[{"\[Chi]", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", 
            RowBox[{"pos", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"i", ",", " ", "1", ",", " ", 
            RowBox[{"Length", "[", "\[Chi]", "]"}]}], "}"}]}], "]"}], "//", 
        "Flatten"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ne", "=", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Extract", "[", 
           RowBox[{"ne", ",", " ", 
            RowBox[{"pos", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"i", ",", " ", "1", ",", " ", 
            RowBox[{"Length", "[", "pos", "]"}]}], "}"}]}], "]"}], "//", 
        "Flatten"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"dens", "=", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Extract", "[", 
           RowBox[{"dens", ",", " ", 
            RowBox[{"pos", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"i", ",", " ", "1", ",", " ", 
            RowBox[{"Length", "[", "pos", "]"}]}], "}"}]}], "]"}], "//", 
        "Flatten"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T", "=", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Extract", "[", 
           RowBox[{"T", ",", " ", 
            RowBox[{"pos", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"i", ",", " ", "1", ",", " ", 
            RowBox[{"Length", "[", "pos", "]"}]}], "}"}]}], "]"}], "//", 
        "Flattenq"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Transpose", "[", 
       RowBox[{"{", 
        RowBox[{"\[Nu]", ",", " ", "T"}], "}"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Mu]e", "=", 
       RowBox[{"ne", " ", 
        FractionBox["mp", "dens"]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Sigma]", "=", 
       RowBox[{"\[Mu]e", " ", "0.4"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Kappa]", "=", "\[Chi]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Epsilon]", "=", 
       FractionBox["\[Kappa]", 
        RowBox[{"\[Kappa]", "+", "\[Sigma]"}]]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"gb1", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\[Nu]", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", " ", 
           RowBox[{
            RowBox[{"\[Nu]", "[", 
             RowBox[{"[", "i", "]"}], "]"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"B", "[", 
               RowBox[{"T", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "]"}], "/.", 
              RowBox[{"{", 
               RowBox[{"\[Nu]1", "\[Rule]", 
                RowBox[{"\[Nu]", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], ")"}], 
            FractionBox[
             SuperscriptBox[
              RowBox[{"\[Epsilon]", "[", 
               RowBox[{"[", "i", "]"}], "]"}], 
              RowBox[{"1", "/", "2"}]], 
             RowBox[{"1", "+", 
              SuperscriptBox[
               RowBox[{"\[Epsilon]", "[", 
                RowBox[{"[", "i", "]"}], "]"}], 
               RowBox[{"1", "/", "2"}]]}]]}]}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"i", ",", " ", "1", ",", " ", 
           RowBox[{"Length", "[", "\[Nu]", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"tlustyspec", "=", 
       RowBox[{"PlotF", "[", 
        RowBox[{
         RowBox[{"dir", "<>", " ", "\"\</fort.13\>\""}], ",", "Green", ",", 
         " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"0.1", " ", 
            RowBox[{"\[Nu]peak", "[", "Teff", "]"}]}], ",", " ", 
           RowBox[{"10", " ", 
            RowBox[{"\[Nu]peak", "[", "Teff", "]"}]}]}], "}"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"gp1", "=", 
       RowBox[{"ListLogLogPlot", "[", 
        RowBox[{"gb1", ",", " ", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"1.8", " ", 
               SuperscriptBox["10", "14"]}], ",", " ", 
              RowBox[{"5", " ", 
               SuperscriptBox["10", "15"]}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              SuperscriptBox["10", "6"], ",", " ", 
              SuperscriptBox["10", "12"]}], "}"}]}], "}"}]}], ",", " ", 
         RowBox[{"Joined", "\[Rule]", "True"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"planck", "=", 
          RowBox[{
           RowBox[{"B", "[", "Tp", "]"}], "/.", 
           RowBox[{"\[Nu]1", "\[Rule]", "\[Nu]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"gp", "=", 
          RowBox[{"ListLogLogPlot", "[", 
           RowBox[{
            RowBox[{"Transpose", "[", 
             RowBox[{"{", 
              RowBox[{"\[Nu]", ",", " ", 
               RowBox[{"\[Nu]", 
                FractionBox[
                 SuperscriptBox["\[Epsilon]", 
                  RowBox[{"1", "/", "2"}]], 
                 RowBox[{"1", "+", 
                  SuperscriptBox["\[Epsilon]", 
                   RowBox[{"1", "/", "2"}]]}]], "planck"}]}], "}"}], "]"}], 
            ",", " ", 
            RowBox[{"PlotRange", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"0.1", " ", 
                  RowBox[{"\[Nu]peak", "[", "Teff", "]"}]}], ",", " ", 
                 RowBox[{"10", " ", 
                  RowBox[{"\[Nu]peak", "[", "Teff", "]"}]}]}], "}"}], ",", 
               "All"}], "}"}]}], ",", " ", 
            RowBox[{"Joined", "\[Rule]", "True"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"GraphicsColumn", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Show", "[", 
             RowBox[{"{", 
              RowBox[{"tlustyspec", ",", " ", "gp1"}], "}"}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Show", "[", 
             RowBox[{"{", " ", 
              RowBox[{"tlustyspec", ",", " ", "gp"}], "}"}], "]"}]}], "}"}], 
          "]"}]}], "\[IndentingNewLine]", ",", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Tp", ",", " ", "Teff"}], "}"}], ",", " ", 
          FractionBox["Teff", "2"], ",", 
          RowBox[{"2", " ", "Teff"}]}], "}"}], "\[IndentingNewLine]", ",", 
        " ", 
        RowBox[{"TrackedSymbols", "\[RuleDelayed]", "Tp"}]}], "]"}]}]}], 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True],

Cell[BoxData["\[IndentingNewLine]"], "Input"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"atm", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
       "ParseAtm", "[", 
        "\"\<~/First_Year_Project/tlusty_tar/examples/aleksey_tlusty_runs/t40_\
solar/t40m56q-143/converged/fort.7\>\"", "]"}], "\[IndentingNewLine]", "nh"}],
       "=", 
      RowBox[{"0.74", " ", 
       FractionBox[
        RowBox[{
         RowBox[{"atm", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "4"}], "]"}], "]"}], " "}], "mp"]}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"ne", "=", 
     RowBox[{"atm", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "3"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    
    FractionBox["ne", "nh"], ";"}], "*)"}], "\[IndentingNewLine]"}]], "Input"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Tp", "=", 
     SuperscriptBox["10", "4"]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Read", " ", "in", "  ", "list", " ", "of", " ", "opacities"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"o", "=", 
     RowBox[{
     "Opac", "[", 
      "\"\<~/First_Year_Project/tlusty_tar/examples/aleksey_tlusty_runs/t40_\
isot/fort.85\>\"", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Chi]", "=", 
     RowBox[{"o", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", " ", "2", ",", " ", "1"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"freq", "=", 
     RowBox[{"o", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Scattering", " ", "opacity"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Mu]e", "=", "0.74"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Sigma]", "=", 
     RowBox[{"\[Mu]e", " ", "0.4"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Kappa]", "=", "\[Chi]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Pure", " ", "absorption", " ", "opacity"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Kappa]", "=", 
     RowBox[{"\[Kappa]", "-", "\[Sigma]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Epsilon]", "=", "\[Kappa]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Extinction", " ", "probability"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Epsilon]", "=", 
     FractionBox["\[Kappa]", 
      RowBox[{"\[Kappa]", "+", "\[Sigma]"}]]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"bb", "=", 
     RowBox[{
      RowBox[{"\[Nu]1", " ", 
       RowBox[{"B", "[", 
        SuperscriptBox["10", "4"], "]"}]}], "/.", 
      RowBox[{"\[Nu]1", "\[Rule]", "freq"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"gb", "=", 
     RowBox[{"2", "\[Pi]", "  ", 
      FractionBox[
       SuperscriptBox["\[Epsilon]", 
        RowBox[{"1", "/", "2"}]], 
       RowBox[{
        SuperscriptBox["\[Epsilon]", 
         RowBox[{"1", "/", "2"}]], "+", "1"}]], " ", "bb"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Show", "[", 
    RowBox[{
     RowBox[{
     "PlotF", "[", 
      "\"\<~/First_Year_Project/tlusty_tar/examples/aleksey_tlusty_runs/t40_\
isot/fort.13\>\"", "]"}], ",", " ", 
     RowBox[{"ListLogLogPlot", "[", 
      RowBox[{"Transpose", "[", 
       RowBox[{"{", 
        RowBox[{"freq", ",", " ", "gb"}], "}"}], "]"}], "]"}]}], "]"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input"],

Cell[BoxData["\[IndentingNewLine]"], "Input"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
  "PlotF", "[", 
   "\"\<~/First_Year_Project/tlusty_tar/examples/aleksey_tlusty_runs/t40_isot/\
fort.13\>\"", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"dmtot", "=", "5"}], ";", "\[IndentingNewLine]", 
   RowBox[{"m0", "=", 
    RowBox[{"-", "3"}]}], ";", "\[IndentingNewLine]", 
   RowBox[{"logm", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Range", "[", 
       RowBox[{"m0", ",", " ", "dmtot", ",", " ", 
        FractionBox["8", "69"]}], "]"}], "\[IndentingNewLine]", "m"}], "=", 
     RowBox[{
      SuperscriptBox["10", "logm"], "//", 
      RowBox[{"N", "\[IndentingNewLine]", 
       RowBox[{"\[Rho]c", "=", 
        SuperscriptBox["10", 
         RowBox[{"-", "11"}]]}]}]}]}]}], ";", "\[IndentingNewLine]", 
   RowBox[{"Tp", "=", 
    SuperscriptBox["10", "4"]}], ";", "\[IndentingNewLine]", 
   RowBox[{"ne", "=", 
    RowBox[{"0.74", " ", 
     FractionBox["\[Rho]c", "mp"]}]}], ";", "\[IndentingNewLine]", 
   RowBox[{"atm", "=", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Tp", ",", " ", "ne", ",", " ", "\[Rho]c", ",", "0"}], "}"}], 
       ",", " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", " ", 
         RowBox[{"1", " ", "70"}]}], "}"}]}], "]"}], "//", "N"}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{"atm", "=", 
    RowBox[{"Flatten", "/@", 
     RowBox[{"Transpose", "[", 
      RowBox[{"{", 
       RowBox[{"m", ",", " ", "atm"}], "}"}], "]"}]}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"getting", " ", "the", " ", "correct", " ", "z"}], "-", 
     "coordinate"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"atm", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", " ", 
       RowBox[{"-", "1"}]}], "]"}], "]"}], "=", 
    RowBox[{
     RowBox[{"atm", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", " ", "1"}], "]"}], "]"}], "/", 
     RowBox[{"atm", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "4"}], "]"}], "]"}]}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Row", "[", 
       RowBox[{"m", ",", " ", "\"\<    \>\""}], "]"}], "\[IndentingNewLine]", 
      
      RowBox[{"(", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ScientificForm", "[", 
           RowBox[{"#", ",", 
            RowBox[{"NumberFormat", "->", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"SequenceForm", "[", 
                RowBox[{"#1", ",", "\"\<E\>\"", ",", "#3"}], "]"}], "&"}], 
              ")"}]}]}], " ", "]"}], "&"}], ",", 
         RowBox[{"atm", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", " ", 
            RowBox[{"2", ";;"}]}], "]"}], "]"}], ",", " ", 
         RowBox[{"{", "2", "}"}]}], "]"}], ")"}]}], "//", "Reverse"}], "//", 
    "TableForm"}]}], "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"atm", "=", " ", 
     RowBox[{
     "ParseAtm", "[", 
      "\"\<~/First_Year_Project/tlusty_tar/examples/aleksey_tlusty_runs/tmp/\
fort.7\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"m", "=", 
     RowBox[{"atm", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", " ", "1"}], "]"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"o", "=", 
     RowBox[{
     "Opac", "[", 
      "\"\<~/First_Year_Project/tlusty_tar/examples/aleksey_tlusty_runs/tmp/\
fort.85\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"\[Mu]e", "=", 
     RowBox[{"mp", 
      FractionBox[
       RowBox[{"atm", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "3"}], "]"}], "]"}], 
       RowBox[{"atm", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "4"}], "]"}], "]"}]]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"\[Sigma]", "=", 
     RowBox[{"\[Mu]e", " ", "0.4"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"\[Sigma]", "=", 
     RowBox[{"\[Sigma]", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{
      "opacities", " ", "at", " ", "various", " ", "frequencies", " ", "for", 
       " ", "the", " ", "outer"}], "-", 
      RowBox[{"most", " ", "depth", " ", "point"}]}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"o1", "=", 
     RowBox[{"Transpose", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"o", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", " ", "1"}], "]"}], "]"}], ",", 
        RowBox[{"o", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "2", ",", " ", "1"}], "]"}], "]"}]}], "}"}], 
      "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"\[Kappa]", "=", 
     RowBox[{
      RowBox[{"o1", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", " ", "2"}], "]"}], "]"}], "-", "\[Sigma]"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"\[Epsilon]", "=", 
     FractionBox["\[Kappa]", 
      RowBox[{"\[Kappa]", "+", "\[Sigma]"}]]}], ";", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
     "Extinction", " ", "probabilities", " ", "at", " ", "the", " ", "outer", 
      " ", "most", " ", "part", " ", "of", " ", "the", " ", "atmosphere"}], 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{"\[Epsilon]", "=", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"#", "<", "0"}], ",", " ", "0", ",", " ", "#"}], "]"}], 
        "&"}], ",", " ", "\[Epsilon]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    
    RowBox[{"freq", "=", 
     RowBox[{"o1", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    
    RowBox[{"planck", "=", 
     RowBox[{
      RowBox[{"B", "[", "Tp", "]"}], "/.", 
      RowBox[{"{", 
       RowBox[{"\[Nu]1", "->", "freq"}], "}"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"\[Epsilon]", "=", 
     RowBox[{"\[Epsilon]", "[", 
      RowBox[{"[", 
       RowBox[{"2", ";;"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"planck", "=", 
     RowBox[{"planck", "[", 
      RowBox[{"[", 
       RowBox[{"2", ";;"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"flux", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"freq", "//", "Differences"}], ")"}], 
       FractionBox[
        SuperscriptBox["\[Epsilon]", 
         RowBox[{"1", "/", "2"}]], 
        RowBox[{
         SuperscriptBox["\[Epsilon]", 
          RowBox[{"1", "/", "2"}]], "+", "1"}]], "planck"}], "//", 
      "Total"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"flux", "=", 
     RowBox[{
      RowBox[{"-", "2"}], " ", "\[Pi]", " ", "flux"}]}]}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}]], "Input"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"dat", "=", 
     RowBox[{"ReadList", "[", 
      RowBox[{
      "\"\<~/First_Year_Project/tlusty_tar/examples/aleksey_tlusty_runs/t40/\
fort.85\>\"", ",", " ", "Number", ",", " ", 
       RowBox[{"RecordLists", "\[Rule]", "True"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"nd", "=", "70"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Tp", "=", "10600"}], ";", "\[IndentingNewLine]", 
    RowBox[{"(*", "frequencies", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"\[Nu]", "=", 
     RowBox[{"Extract", "[", 
      RowBox[{"dat", ",", " ", 
       RowBox[{"Position", "[", 
        RowBox[{"dat", ",", " ", 
         RowBox[{"x_", "/;", 
          RowBox[{
           RowBox[{"Length", "[", "x", "]"}], "\[Equal]", "2"}]}]}], "]"}]}], 
      "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"\[Nu]", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Nu]", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "2"}], "]"}], "]"}], "\[IndentingNewLine]", 
       "\[Kappa]"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"DeleteCases", "[", 
         RowBox[{"dat", ",", 
          RowBox[{"x_", "/;", 
           RowBox[{
            RowBox[{"Length", "[", "x", "]"}], "\[Equal]", "2"}]}]}], "]"}], 
        "\[IndentingNewLine]", "\[Kappa]"}], "=", 
       RowBox[{
        RowBox[{"\[Kappa]", "//", "Flatten"}], "//", 
        RowBox[{
         RowBox[{
          RowBox[{"Partition", "[", 
           RowBox[{"#", ",", " ", "nd"}], "]"}], "&"}], "\[IndentingNewLine]", 
         RowBox[{"\[Kappa]es", "=", "0.4"}]}]}]}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"tmp", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"#", "*", " ", 
        RowBox[{"Prepend", "[", 
         RowBox[{
          RowBox[{"md", "//", "Differences"}], ",", " ", 
          RowBox[{"md", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "&"}], "/@", 
      "\[Kappa]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"tmp2", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"FoldList", "[", 
        RowBox[{"Plus", ",", "0", ",", " ", "#"}], "]"}], "&"}], "/@", 
      "tmp"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"tmp3", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Nearest", "[", 
         RowBox[{"#", ",", " ", "1"}], "]"}], "&"}], "/@", "tmp2"}], "//", 
      "Flatten"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"tmppos", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Position", "[", 
        RowBox[{
         RowBox[{"tmp2", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", " ", 
         RowBox[{"tmp3", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", " ", "1", ",", " ", 
         RowBox[{"Length", "[", "tmp2", "]"}]}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"\[Kappa]abs", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Extract", "[", 
           RowBox[{
            RowBox[{"\[Kappa]", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", " ", 
            RowBox[{"tmppos", " ", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"i", ",", " ", "1", ",", " ", 
            RowBox[{"Length", "[", "tmppos", "]"}]}], "}"}]}], "]"}], "//", 
        "Flatten"}], ")"}], "-", "0.4"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"\[Kappa]abs", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"#", "<", "0"}], ",", " ", "0", ",", " ", "#"}], "]"}], 
       "&"}], "/@", "\[Kappa]abs"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"\[Epsilon]", "=", 
     FractionBox["\[Kappa]abs", 
      RowBox[{"\[Kappa]abs", "+", "\[Kappa]es"}]]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"gray", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Nu]", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", " ", 
         RowBox[{
          RowBox[{
           FractionBox[
            SuperscriptBox[
             RowBox[{"\[Epsilon]", "[", 
              RowBox[{"[", "i", "]"}], "]"}], 
             RowBox[{"1", "/", "2"}]], 
            RowBox[{"1", "+", 
             SuperscriptBox[
              RowBox[{"\[Epsilon]", "[", 
               RowBox[{"[", "i", "]"}], "]"}], 
              RowBox[{"1", "/", "2"}]]}]], 
           RowBox[{"B", "[", "Tp", "]"}], " ", "\[Nu]1"}], "/.", 
          RowBox[{"\[Nu]1", "\[Rule]", 
           RowBox[{"\[Nu]", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}]}]}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", " ", "1", ",", " ", 
         RowBox[{"Length", "[", "\[Nu]", "]"}]}], "}"}]}], "]"}]}]}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"gp2", "=", 
    RowBox[{"ListLogLogPlot", "[", 
     RowBox[{"gray", ",", " ", 
      RowBox[{"Joined", "\[Rule]", "True"}]}], "]"}]}], "*)"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"GraybodyCompare", "[", 
    RowBox[{
    "\"\<~/First_Year_Project/tlusty_tar/examples/aleksey_tlusty_runs/t40_\
solar/t40m36q-123/converged/fort.13\>\"", ",", " ", 
     SuperscriptBox["10", "4"], ",", " ", 
     RowBox[{"5.01", " ", 
      SuperscriptBox["10", 
       RowBox[{"-", "13"}]]}]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"GraybodyCompare", "[", 
    RowBox[{
    "\"\<~/First_Year_Project/tlusty_tar/examples/aleksey_tlusty_runs/t40_\
solar/t40m56q-143/converged/fort.13\>\"", ",", " ", 
     SuperscriptBox["10", "4"], ",", " ", 
     RowBox[{"5.01", " ", 
      SuperscriptBox["10", 
       RowBox[{"-", "15"}]]}]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"GraybodyCompare", "[", 
    RowBox[{
    "\"\<~/First_Year_Project/tlusty_tar/examples/aleksey_tlusty_runs/t40_\
solar/t40m56q-143/lteconv/fort.13\>\"", ",", " ", 
     SuperscriptBox["10", "4"], ",", " ", 
     RowBox[{"5.01", " ", 
      SuperscriptBox["10", 
       RowBox[{"-", "15"}]]}]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"GraybodyCompare", "[", 
    RowBox[{
    "\"\<~/First_Year_Project/tlusty_tar/examples/aleksey_tlusty_runs/t40_\
solar/t47m58q-86/lteconv/fort.13\>\"", ",", " ", 
     SuperscriptBox["10", "4.7"], ",", " ", 
     SuperscriptBox["10", 
      RowBox[{"-", "8.6"}]]}], "]"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Teff", "=", 
     SuperscriptBox["10", "4"]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Qg", "=", 
     RowBox[{"5.01", " ", 
      SuperscriptBox["10", 
       RowBox[{"-", "13"}]]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"m", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
        "ParseAtm", "[", 
         "\"\<~/First_Year_Project/tlusty_tar/examples/aleksey_tlusty_runs/\
t40_solar/t40m56q-143/converged/fort.7\>\"", "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "1"}], "]"}], "]"}], "\[IndentingNewLine]", 
       "o"}], "=", 
      RowBox[{
       RowBox[{
       "Opac", "[", 
        "\"\<~/First_Year_Project/tlusty_tar/examples/aleksey_tlusty_runs/t40_\
solar/t40m56q-143/converged/fort.85\>\"", "]"}], "//", "Reverse"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"\[Chi]", "=", 
     RowBox[{
      RowBox[{"o", "//", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "2"}], "]"}], "]"}], "&"}], 
        "\[IndentingNewLine]", "\[Nu]"}]}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"o", "//", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"-", "1"}], ",", " ", "1"}], "]"}], "]"}], "&"}], 
          "\[IndentingNewLine]", 
          RowBox[{"Transpose", "[", 
           RowBox[{"{", 
            RowBox[{"m", ",", " ", "\[Chi]"}], "}"}], "]"}]}]}], "//", 
        RowBox[{"ListLogLogPlot", "\[IndentingNewLine]", "\[Epsilon]"}]}], 
       "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"GrayBody", "[", 
             RowBox[{"Teff", ",", " ", "Qg"}], "]"}], "[", 
            RowBox[{"[", "3", "]"}], "]"}], "/.", 
           RowBox[{"\[Nu]1", "\[Rule]", "\[Nu]"}]}], "//", "Re"}], "//", 
         RowBox[{"ScientificForm", "\[IndentingNewLine]", "Tp"}]}], "=", 
        RowBox[{
         RowBox[{"GrayBody", "[", 
          RowBox[{"Teff", ",", " ", "Qg"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}]}]}]}]}], "\[IndentingNewLine]", 
   "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}]], "Input"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"o", "=", 
     RowBox[{
     "Opac", "[", 
      "\"\<~/First_Year_Project/tlusty_tar/examples/aleksey_tlusty_runs/t40_\
solar/t40m56q-143/converged/fort.85\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"atm", "=", 
     RowBox[{
     "ParseAtm", "[", 
      "\"\<~/First_Year_Project/tlusty_tar/examples/aleksey_tlusty_runs/t40_\
solar/t40m56q-143/converged/fort.7\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
    
    RowBox[{"ne", "=", 
     RowBox[{"atm", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "3"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    
    RowBox[{"dens", "=", 
     RowBox[{"atm", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "4"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    
    RowBox[{"z", "=", 
     RowBox[{"atm", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "5"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    
    RowBox[{"T", "=", 
     RowBox[{"atm", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    
    RowBox[{"\[Delta]z", "=", 
     RowBox[{"z", "//", "Differences"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"o", "=", 
     RowBox[{"o", "//", "Reverse"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"\[Chi]", "=", 
     RowBox[{"o", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    
    RowBox[{"\[Nu]", "=", 
     RowBox[{"o", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    
    RowBox[{"\[Tau]", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"#", "[", 
          RowBox[{"[", 
           RowBox[{"2", ";;"}], "]"}], "]"}]}], " ", "\[Delta]z", " ", 
        RowBox[{"dens", "[", 
         RowBox[{"[", 
          RowBox[{"2", ";;"}], "]"}], "]"}]}], "&"}], "/@", "\[Chi]"}]}], ";",
     "\[IndentingNewLine]", 
    RowBox[{"near", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Nearest", "[", 
        RowBox[{"#", ",", "1"}], "]"}], "&"}], "/@", "\[Tau]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"pos", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Position", "[", " ", 
        RowBox[{
         RowBox[{"\[Tau]", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", " ", 
         RowBox[{"near", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "1"}], "]"}], "]"}]}], "]"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", " ", "1", ",", " ", 
         RowBox[{"Length", "[", "near", "]"}]}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
     "Total", " ", "opacity", " ", "at", " ", "the", " ", "photosphere"}], 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{"\[Chi]", "=", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Extract", "[", 
         RowBox[{
          RowBox[{"\[Chi]", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{"pos", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", " ", "1", ",", " ", 
          RowBox[{"Length", "[", "\[Chi]", "]"}]}], "}"}]}], "]"}], "//", 
      "Flatten"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"ne", "=", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Extract", "[", 
         RowBox[{"ne", ",", " ", 
          RowBox[{"pos", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", " ", "1", ",", " ", 
          RowBox[{"Length", "[", "pos", "]"}]}], "}"}]}], "]"}], "//", 
      "Flatten"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"dens", "=", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Extract", "[", 
         RowBox[{"dens", ",", " ", 
          RowBox[{"pos", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", " ", "1", ",", " ", 
          RowBox[{"Length", "[", "pos", "]"}]}], "}"}]}], "]"}], "//", 
      "Flatten"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"T", "=", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Extract", "[", 
         RowBox[{"T", ",", " ", 
          RowBox[{"pos", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", " ", "1", ",", " ", 
          RowBox[{"Length", "[", "pos", "]"}]}], "}"}]}], "]"}], "//", 
      "Flatten"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"\[Mu]e", "=", 
     RowBox[{"ne", " ", 
      FractionBox["mp", "dens"]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"\[Sigma]", "=", 
     RowBox[{"\[Mu]e", " ", "0.4"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"\[Kappa]", "=", "\[Chi]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"\[Epsilon]", "=", 
     FractionBox["\[Kappa]", 
      RowBox[{"\[Kappa]", "+", "\[Sigma]"}]]}], ";", "\[IndentingNewLine]", 
    RowBox[{"spec", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Nu]", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", " ", 
         RowBox[{
          RowBox[{"\[Nu]", "[", 
           RowBox[{"[", "i", "]"}], "]"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"B", "[", 
             RowBox[{"T", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}], "/.", 
            RowBox[{"{", 
             RowBox[{"\[Nu]1", "\[Rule]", 
              RowBox[{"\[Nu]", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], ")"}], 
          FractionBox[
           SuperscriptBox[
            RowBox[{"\[Epsilon]", "[", 
             RowBox[{"[", "i", "]"}], "]"}], 
            RowBox[{"1", "/", "2"}]], 
           RowBox[{"1", "+", 
            SuperscriptBox[
             RowBox[{"\[Epsilon]", "[", 
              RowBox[{"[", "i", "]"}], "]"}], 
             RowBox[{"1", "/", "2"}]]}]]}]}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", " ", "1", ",", " ", 
         RowBox[{"Length", "[", "\[Nu]", "]"}]}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"tlustynlte", "=", 
     RowBox[{"PlotSpec", "[", 
      RowBox[{
      "\"\<~/First_Year_Project/tlusty_tar/examples/aleksey_tlusty_runs/t40_\
solar/t40m56q-143/converged/fort.14\>\"", ",", "Green"}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"pspec", "=", 
     RowBox[{"ListLogLogPlot", "[", 
      RowBox[{"spec", ",", " ", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"1.8", " ", 
             SuperscriptBox["10", "14"]}], ",", " ", 
            RowBox[{"5", " ", 
             SuperscriptBox["10", "15"]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            SuperscriptBox["10", "6"], ",", " ", 
            SuperscriptBox["10", "12"]}], "}"}]}], "}"}]}], ",", " ", 
       RowBox[{"Joined", "\[Rule]", "True"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Show", "[", 
      RowBox[{"pspec", ",", "tlustynlte"}], "]"}], "\[IndentingNewLine]", 
     RowBox[{"Manipulate", "[", 
      RowBox[{
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"gb", ",", " ", "planck"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"planck", "=", 
           RowBox[{
            RowBox[{"B", "[", "Tp", "]"}], "/.", 
            RowBox[{"\[Nu]1", "\[Rule]", "\[Nu]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"gb", "=", 
           RowBox[{"ListLogLogPlot", "[", 
            RowBox[{
             RowBox[{"Transpose", "[", 
              RowBox[{"{", 
               RowBox[{"\[Nu]", ",", " ", 
                RowBox[{"\[Nu]", 
                 FractionBox[
                  SuperscriptBox["\[Epsilon]", 
                   RowBox[{"1", "/", "2"}]], 
                  RowBox[{"1", "+", 
                   SuperscriptBox["\[Epsilon]", 
                    RowBox[{"1", "/", "2"}]]}]], "planck"}]}], "}"}], "]"}], 
             ",", " ", 
             RowBox[{"PlotRange", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"1.8", " ", 
                   SuperscriptBox["10", "14"]}], ",", " ", 
                  RowBox[{"5", " ", 
                   SuperscriptBox["10", "15"]}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  SuperscriptBox["10", "6"], ",", " ", 
                  SuperscriptBox["10", "12"]}], "}"}]}], "}"}]}], ",", " ", 
             RowBox[{"Joined", "\[Rule]", "True"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Show", "[", 
           RowBox[{"{", 
            RowBox[{"gb", ",", "tlustynlte"}], "}"}], "]"}]}]}], "]"}], 
       "\[IndentingNewLine]", ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Tp", ",", " ", "12000"}], "}"}], ",", " ", "10000", ",", 
         " ", "30000"}], "}"}]}], "]"}]}]}], "*)"}], 
  "\[IndentingNewLine]"}]], "Input"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"GraybodyCompare2", "[", 
   RowBox[{
   "\"\<~/First_Year_Project/tlusty_tar/examples/aleksey_tlusty_runs/t40_\
solar/t40m56q-143/converged\>\"", ",", " ", 
    SuperscriptBox["10", "4"], ",", " ", 
    RowBox[{"5.01", " ", 
     SuperscriptBox["10", 
      RowBox[{"-", "15"}]]}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"atm", "=", 
     RowBox[{
     "ParseAtm", "[", 
      "\"\<~/First_Year_Project/tlusty_tar/examples/aleksey_tlusty_runs/t60/\
t60m50q15/lteconv/fort.7\>\"", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"ListLinePlot", "[", 
     RowBox[{
      RowBox[{"atm", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", " ", 
           RowBox[{"-", "2"}]}], "}"}]}], "]"}], "]"}], ",", " ", 
      RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"4", " ", "\[Sigma]b"}]}]}]], "Input"]
},
AutoGeneratedPackage->None,
WindowSize->{1320, 1046},
WindowMargins->{{164, Automatic}, {Automatic, 157}},
PrintingPageRange->{Automatic, Automatic},
PrintingOptions->{"Magnification"->1.,
"PaperOrientation"->"Portrait",
"PaperSize"->{611.28, 789.57},
"PostScriptOutputFile"->"/home/aleksey/First_Year_Project/Graybody2.nb.ps"},
ShowSelection->True,
FrontEndVersion->"7.0 for Linux x86 (64-bit) (October 28, 2009)",
StyleDefinitions->"Default.nb"
]

